<!DOCTYPE HTML>
<!--
	Ion by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>Right Sidebar - Ion by TEMPLATED</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
	</head>
	<body id="top">

		<!-- Header -->
			<header id="header" class="skel-layers-fixed">
				<h1><a href="#">Ion</a></h1>
				<nav id="nav">
					<ul>
						<li><a href="page2.html">Home</a></li>
						<li><a href="left-sidebar.html">Left Sidebar</a></li>
						<li><a href="right-sidebar.html">Right Sidebar</a></li>
						<li><a href="no-sidebar.html">No Sidebar</a></li>
						<li><a href="javascript:void(0);" id= "logoutbut" class="button special">Admin Log Out</a></li>
					</ul>
				</nav>
			</header>
			<script>

			$("#logoutbut").on( 'click', function () {
				$.ajax({
				type: 'post',
				url: 'logout.php',
				data: {
		        	search0: "ty",
		            
		        },
				dataType: 'json',
				success: function( data ) {
					if (data[0]=="An Error Occured. Please try again"){
						window.alert("An Error Occured. Please try again");
					}
					
					else{
						window.open('adminloginform.html','_self');
						
					}
					return false;
				}

				});
			});
			</script>

		<!-- Main -->
			<section id="main" class="wrapper style1">
				<header class="major">
					<h2>Course Page</h2>
					<p>Contains Course Details</p>
				</header>
				<div class="container">
					<div class="row">
						<div class="4u">

							<SCRIPT Language="JavaScript">

							function getcoloury(num)
								{ num   = Math.round(num);
									if (num==1){
										return "#C00000"
									}
									if (num==2){
										return "#FFA500"
									}
									if (num==3){
										return "#FFFF00"
									}
									if (num==4){
										return "#009900"
									}
									if (num==5){
										return "#003300"
									}
								}

								
								function colourotrating()
								{
									var x = document.getElementsByClassName("boxotr");
									for (var i = 0; i < x.length; ++i) {
										var ele = x[i]; 
										if (ele.id=='revnumh'){
											ele.style.backgroundColor=getcoloury(1);
										}
										else if (ele.id=='revnumm'){
											ele.style.backgroundColor=getcoloury(2);
										}
										else if (ele.id=='revnumt'){
											ele.style.backgroundColor="#0000ff";
										}
										else if (ele.id=='revnuml'){
											ele.style.backgroundColor=getcoloury(3);
										}
										else{
											idr = ele.textContent;
											ele.style.backgroundColor=getcoloury(idr);
										}
										
									}
									
								}

								function colourorating()
								{
									var x = document.getElementsByClassName("boxor");
									for (var i = 0; i < x.length; ++i) {
										var ele = x[i];  
										idr = ele.textContent;
										ele.style.backgroundColor=getcoloury(idr);
									}
									
								}
								</script>
								<script>


									
									$( window ).load(function() {
											$.ajax({
											type: 'post',
											url: 'checklogin.php',
											data: {
									        	search0: "ty",
									            
									        },
											dataType: 'json',
											success: function( data ) {
												if (data[0]=="Multiple Admins Logged in"){
													window.alert("Multiple Admins Logged in - All Logging Out");
													window.open("adminloginform.html",'_self')
												}
												else if (data[0]=="No Admin Logged in"){
													window.alert("You are not logged in.");
													window.open('adminloginform.html','_self');
												}
												else{
													window.alert("Welcome Admin");
												}
												return false;
											}

											});
										});

									var reviewdata;

									function reloadreviewsspecial() {
										$.ajax({
										        type: 'post',
										        async:false,
										        url: 'promptrev.php',
										        data: {
										        	search0: "ty"
										        },
										        dataType: 'json',
										        success: function( data ) {
										        	reviewdata=data;
										        	console.log(reviewdata[2]);	
										        											        	

										   			
										        	return false;
										        }


										});
									}




									//var reviewdata = window.opener.reviewdata;
									reloadreviewsspecial();
									

									var hig = parseInt(reviewdata[0],10);
										var med = parseInt(reviewdata[1],10);
										var low = parseInt(reviewdata[2],10);
										var tot = hig+med+low;

										colourotrating();
									
									
									// $( window ).load(function() {
									// 	var hig = parseInt(reviewdata[0],10);
									// 	var med = parseInt(reviewdata[1],10);
									// 	var low = parseInt(reviewdata[2],10);
									// 	var tot = hig+med+low;
										
									// 	document.getElementById("revnumh").innerHTML = hig;
									// 	document.getElementById("revnumm").innerHTML = med;
									// 	document.getElementById("revnuml").innerHTML = low;
									// 	document.getElementById("revnumt").innerHTML = tot;
									// 	colourotrating();

									// });
								</script>
							
							<section class="boxcp">
								<h3>Statistics</h3>

									<section class="special box">
									<section class = "boxotr" id = "revnumh"><script>document.write(hig);</script></section>
									<h4>High Reports</h4>
									</section>

									<section class="special box">
									<section class = "boxotr" id = "revnumm"><script>document.write(med);</script></section>
									<h4>Medium Reports</h4>
									</section>

									<section class="special box">
									<section class = "boxotr" id = "revnuml" onChange="callfunc();"><script>document.write(low);</script></section>
									<h4>Low Reports</h4>
									</section>

									<section class="special box">
									<section class = "boxotr" id = "revnumt"><script>document.write(tot);</script></section>
									<h4>Total</h4>
									</section>
									
									<SCRIPT Language="JavaScript">
									function callfunc(){
										var newwindow = window.open('seepromptreviews.html','_self')	;
									}
									
									</SCRIPT>

									
								</ul>
							</section>
						</div>

						<div class="7u">
							<section>

								
								<section class="special box">
									<h2>Top Reported Reviews</h2>
									<script Language="JavaScript">
											function getcolour(num)
											{
												if (num==1){
													return "#C00000"
												}
												if (num==2){
													return "#FFA500"
												}
												if (num==3){
													return "#FFFF00"
												}
												if (num==4){
													return "#009900"
												}
												if (num==5){
													return "#003300"
												}
											}

											function colourGreen(ele)
											{
												idr = ele.id;
												ele.style.backgroundColor=getcolour(idr);

											}

											function changetextcolor()
											{
												idr = document.getElementById("addreview");
												idr.style.background="#ffffff";
												idr.style.height="200px";

											}
											//changetextcolor();
										</script>
										
										
								
									<SCRIPT Language="JavaScript">
									//totalnum=7;

																		
									renderreviews(reviewdata.length);

									function renderreviews(totalnum){
										if (totalnum==3){
											document.write('<div class="12u">');
										document.write('<section class="boxnb">');
											document.write('<h2>No Reported reviews</h2>');
											document.write('<h4>Either you are working very well, or the website has encountered an error</h4>');
											document.write('<h4>Good Luck finding out which</h4>');
											
										document.write('</section>');
									document.write('</div>');

										}
										else{
										for (i = 3; i < totalnum; i++) {
										
									
									document.write('<div id="reviewdiv'+i+'">');
									document.write('<hr/>');
									

									document.write('<div class="12u">');
										document.write('<section class="boxnb">');
											document.write('<h2>'+reviewdata[i]['UID']+':'+reviewdata[i]['CID']+'</h2>');
											document.write('<p>'+reviewdata[i]['review']+'</p>')
										document.write('</section>');
									document.write('</div>');

									
										document.write('Upvotes: <input value="'+reviewdata[i]['likes']+'" class="buttup" readonly>');
										document.write(' Downvotes: <input value="'+reviewdata[i]['dislikes']+'" class="buttup" readonly>');
										document.write(' Reports: <input value="'+reviewdata[i]['report']+'" class="buttup" readonly>');
										document.write('<br><br>')

										document.write('<input class = "reviewsubmit" id="'+i+'" type="submit" value="Remove">');
										document.write('</div>');
										


										
										colourotrating();
										colourorating();
									
										}
									//-->
									}

									}

									function your_func(id1){
										window.location.reload();


										// window.open('seepromptreviews.html','');
										// window.close();

										   //   	var hig = parseInt(reviewdata[0],10);
													// var med = parseInt(reviewdata[1],10);
													// var low = parseInt(reviewdata[2],10);
										   //      	document.getElementById('revnumt').innerHTML = hig+med+low;
										   //      	document.getElementById('revnumh').innerHTML = hig;
										   //      	document.getElementById('revnumm').innerHTML = med;
										   //      	document.getElementById('revnuml').innerHTML = low;
										   // 		$("#reviewdiv"+id1).hide();

										return false;
									}

									



									// function reloadreviews(id1) {
									// 	$.ajax({
									// 	        type: 'post',
									// 	        url: 'promptrev.php',
									// 	        data: {
									// 	        	search0: "ty"
									// 	        },
									// 	        dataType: 'json',
									// 	        success: function( data ) {
									// 	        	reviewdata=data;
									// 	        	console.log(reviewdata[2]);	
										        											        	

									// 	   			your_func(id1);
										        	
									// 	        	return false;
									// 	        }

									// 	});
									// }

									// $(document).ready(function() {
									// 	reloadreviews();
										
									// });
									
									$(".reviewsubmit").on( 'click', function () {
										$id1 = $(this).attr("id");
										$uid = reviewdata[$id1]['UID'];
										$cid = reviewdata[$id1]['CID'];
										$.ajax({
									        type: 'post',
									        url: 'removerev.php',
									        data: {
									        	uid:$uid,
									        	cid:$cid
									        },
									        dataType: 'json',
									        success: function( data ) {
									        	your_func($id1);
									        	//reloadreviews($id1);
									        	//$("#reviewdiv"+$id1).hide();
									        	return false;
									        }

									    });
									});
									
									</SCRIPT>
								</section>

							</section>
						</div>
						
					</div>
					
				</div>
			</section>

		<!-- Footer -->
			<footer id="footer">
				<div class="container">
						
					<ul class="copyright">
						<li>&copy; CRS. All rights reserved.</li>
						<li><a href="http://templated.co">About</a></li>
						<li><a href="http://templated.co">Blog</a></li>
						<li><a href="http://templated.co">Contact Us</a></li>
					</ul>
				</div>
			</footer>

	</body>
</html>